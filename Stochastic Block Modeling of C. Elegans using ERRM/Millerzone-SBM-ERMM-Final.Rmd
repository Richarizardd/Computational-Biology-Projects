---
title: "Stochastic Block Modeling of C. Elegans using Erdos-Renyi Mixture Models"
author: "Richard Chen, Karthik Chellamuthu, Kevin Huang, Michael Mow, Edric Tam"
date: "December 14, 205"
output:
  html_document: default
  pdf_document:
    latex_engine: lualatex
---

#Abstract
<<<<<<< Updated upstream
The connectome of the Caenorhabditis elegans (C. elegans) nervous system is one of the most widely studied connectomes in the statistical neuroscience community. In community detection, the C. elegans connectome is often used to validate the functional relevance of major block connectivites obtained. In this project, we tested if a stochastic block model called Erdos-Renyi Mixure Model (ERMM) from Daubin et al. 2008 can discover major block connectivities in the C. Elegans connectome. The null hypothesis, loosely stated, is that the C elegans connectome has just one block. The alternate is that there are more than 1 blocks. Using ERMM, we discovered 16 block connectivities in the C. elegans connectome, and validated its efficacy in being able to penalize higher larger communities with the Integrated Completed Likelihood criterion (ICL). This finding supports our alternate hypothesis in discovering major block connectivites within the C. elegans connectome.
=======
The connectome of the Caenorhabditis elegans (C. elegans) nervous system is one of the most widely studied connectomes in the statistical neuroscience community. In community detection, the C. elegans connectome is often used to validate the functional relevance of major block connectivites obtained. In this project, we tested if a stochastic block model called Erdos-Renyi Mixure Model (ERMM) from Daubin et al. 2008 can discover major block connectivities in the C. Elegans connectome. The null hypothesis, loosely stated, is that the C elegans connectome has just one block. The alternate is that there are more than 1 blocks. Using ERMM, we discovered 14 block connectivities in the C. elegans connectome, and validated its efficacy in being able to penalize higher larger communities with the Integrated Completed Likelihood criterion (ICL). This finding supports our alternate hypothesis in discovering major block connectivites within the C. elegans connectome.
>>>>>>> Stashed changes

##Question
In this project, we tested whether or not major block connectivities exist with the C. Elegans connectome.

Given networks ${G_i}, {i = [1...k]}$, where $G_i \in \mathcal{G}(E,V)$, E defines 4451 weighted edges, V defines 272 vertices in ${G_i}$, and k denotes the number of graphs samplied. In the network ${ \mathbf{G}_i } \sim F$, where $F \sim SBM$, a statistical block model is generated using the Erdos Renyi Mixture Model from MixNet for network structure. Each graph, $G_i$ is sampled independently.

$$ H_0: { \mathbf{G}_i }, {i \in [n]} \sim SBM_1 $$

$$ H_A: { \mathbf{G}_i }, {i \in [n]} \sim SBM_k, {k \geq 2} $$

##Significance
Since brain function is based on inter-regional connections, studying the way cortical regions interact may offer new perspectives in the comprehension of information flows within the brain. However, from a topological view, there is not a formal definition for major block connectivities, and as a result, it is hard to evaluate the efficacy of one particular algorithm over another. The ERRM is another algorithm that assits in discovering major block connectivities, and will hopefully elucidate connections in the brain.

##Innovation
As far as we are concerned, there have been few/no studies investigating the optimal blocking of C Elegans using the ERMM.

##Model
We are using Stochastic Block Model (SBM), ${ \mathbf{G}_i } \sim SBM$. SBM is a  generative statistical block model. It allows us to estimate the connectivity within and between communities.

##Data
The data we used is from the C. elegans connectome graph downloaded from the Open Connectome Project. Given networks ${G_i }, {i \in [2]}$, where $G_i \in \mathcal{G}(E,V)$, the graphs have V = 272 nodes and E = 4451 edges. Edge attributes are weighted and are defined by connection strengths between the nodes.

##Algorithm
Here, we loaded our dependencies in R. The packages "igraph" and "mixer" needs to be installed in order to compute our project.
```{r}
require(igraph); require(mixer)
library(igraph); library(mixer)
```

We load the C. elegans graph from our source directory, and generate its directed adjacency matrix.
```{r}
cElegansGraph <- read.graph("c.elegans_neural.male_1.graphml", format="graphml")
cElegansAdjMatrix <- as.matrix(get.adjacency(cElegansGraph))
```

We used the mixer package to independently sample 20 different graphs of ERRM for C. elegans, returning the graph with the highest ICL criterion.
```{r}
mixerCElegans <- mixer(cElegansAdjMatrix, qmin = 1, qmax= 20)
modelCElegans <- getModel(mixerCElegans)
```

<<<<<<< Updated upstream
We discovered that the graph with the highest ICL criterion was 16, and as a result, we reject the null hypothesis of no major block connectivities.
=======
We discovered that the graph with the highest ICL criterion was 14, and as a result, we reject the null hypothesis of no major block connectivities.
>>>>>>> Stashed changes
```{r}
modelCElegans$q
```

We can see that graphs with block connectivities greater than 16 were penalized, and that ERMM is a useful stochastic block model in community detection in neuroscience.
```{R, fig.width = 10, fig.height = 5}
plot(mixerCElegans, frame=c(1,3))
```

Here, we plotted the reorganized adjacency matrix of C. elegans after applying the ERMM stochastic block model.
```{R, fig.width = 7, fig.height = 7}
plot(mixerCElegans, frame=2)
```

The Inter/intra class probabilities of our winning model of 16 block connectivities.
```{R, fig.width = 7, fig.height = 7}
plot(mixerCElegans, frame=4)
```

##Results

<<<<<<< Updated upstream
Using the ERMM, and leveraging the power of the mixer library, we found 16 blocks to be the optimal way of partitioning the graph of c-elegan connectome, and we reject the null hypothesis that there is only 1 block (the whole graph). We can obtain visual confirmation that the alternate hypothesis of more than 1 block exist by inspecting the adjacency matrix.
=======
Using the ERMM, and leveraging the power of the mixer library, we found 14 blocks to be the optimal way of partitioning the graph of c-elegan connectome, and we reject the null hypothesis that there is only 1 block (the whole graph). We can obtain visual confirmation that the alternate hypothesis of more than 1 block exist by inspecting the adjacency matrix.
>>>>>>> Stashed changes

##Discussion

The C-elegans were chosen because of their well-characterized connectome. The ERMM was chose due to its documentation in literature. Future directions could include testing this paradigm on other animals/humans. 
